<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>评论</title>
    <link rel="stylesheet" href="../css/comment.css">
</head>
<body>
    <header>
        <span id="prev"><img src="../images/prev.png" alt=""></span>
        <span>评论</span>
        <span id="mulu"><img src="../images/mulu.png" alt=""></span>
    </header>
    <!-- 评论列表 -->
    <ul class="list">
        <li>
            <div class="left"><img src="../images/touxiang.png" alt=""></div>
            <div class="right">
                <p class="top">
                    <span>张宇飞</span>
                    <span>2014-10-27</span>
                </p>
                <p class="pingfen">
                    <i>播讲：</i>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                </p>
                <p class="pingfen">
                    <i>内容：</i>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                </p>
                <p class="pingfen">
                    <i>编排：</i>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                    <span><img src="../images/star1.png" alt=""></span>
                </p>
                <p class="pinglun">
                    <i>评论： 那惊鸿一瞥,让我倾尽所有的一切只为了爱你一世的伤心。</i>
                    
                       
                    
                </p>
            </div>
        </li>
        <li>
            <div class="left"><img src="../images/touxiang.png" alt=""></div>
            <div class="right">
                <p class="top">
                    <span>张宇飞</span>
                    <span>2014-10-27</span>
                </p>
                <p class="pingfen" id="speakers">
                    <i>播讲：</i>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </p>
                <p class="pingfen" id="content">
                    <i>内容：</i>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </p>
                <p class="pingfen" id="arrange">
                    <i>编排：</i>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </p>
                <p class="pinglun">
                    <i>评论：
                        ${item.comments}
                    </i>
                    
                </p>
            </div>
        </li>
    </ul>
    <footer id="btn">
        <input type="text" placeholder="发表评论" name="" id="" readonly>
    </footer>

    <!-- 右侧筛选评论 -->
    <div class="filter">
        <div class="filter_title">
            <div>筛选评论</div>
        </div>
        <ul class="filter_cont">
            <li></li>
            <li>按内容</li>
            <li>按播音</li>
            <li>按编排</li>
        </ul>
    </div>
</body>
</html>
<script src="../js/axios.min.js"></script>
<script src="../js/base.js"></script>
<script>
function $(ele){
    return document.querySelector(ele);
}
$('#prev').onclick = function () {
    history.back();
}

$('#btn').onclick = function () {
    location.href = './writeComments.html';
}

let body = $('body');


 // 筛选评论点击事件
let flag1 = true;
    $('#mulu').addEventListener('click', function() {
        if (flag1) {
            body.style.transform = 'translateX(-55rem)';
            $('.filter').style.display = 'block';
            flag1 = false;
        } else {
            body.style.transform = 'translateX(0)';
            // 定时器0.5秒后隐藏
            setTimeout(function() {
                $('.filter').style.display = 'none';
            }, 500);
            flag1 = true;
        }
    });
    function renderStar( class_star,num ){
        let html = '';
        for(let i=1;i<=5;i++){
        html += `<span class="${i<=num?'act':''}"></span>`;
    }
    class_star.innerHTML += html; 
    }

    axios.get('/user/getCommentList').then(res=>{
        console.log(res.data);
        let arr = res.data.data;
        $('.list').innerHTML = '';
        let html = '';
        for(let i=0;i<arr.length;i++){
            let item = arr[i];
            html += `<li>
                        <div class="left"><img src="../images/touxiang.png" alt=""></div>
                        <div class="right">
                            <p class="top">
                                <span>张宇飞</span>
                                <span>2014-10-27</span>
                            </p>
                            <p class="pingfen" id="speakers">
                                <i>播讲：</i>
                               <span></span>   
                               <span></span>   
                               <span></span>   
                               <span></span>   
                               <span></span>   
                            </p>
                            <p class="pingfen" id="content">
                                <i>内容：</i>
                               <span></span>   
                               <span></span>   
                               <span></span>   
                               <span></span>   
                               <span></span>  
                            </p>
                            <p class="pingfen" id="arrange">
                                <i>编排：</i>
                               <span></span>   
                               <span></span>   
                               <span></span>   
                               <span></span>   
                               <span></span>  
                            </p>
                            <p class="pinglun">
                                <i>评论：
                                    ${item.comments}
                                </i>                               
                            </p>
                        </div>
                    </li>`;
                    // renderStar($('#speakers'),item.speakers);
                    // renderStar($('#content'),item.content);
                    // renderStar($('#arrange'),item.arrange);
            //         let html1;
            // let html2;
            // let html3;

            // let num1 = item.speakers;
            // let num2 = item.content;
            // let num3 = item.arrange;
         
            //     html1 += `<span class="${i<=num1?'act':''}"></span>`;
            //     html2 += `<span class="${i<=num2?'act':''}"></span>`;
            //     html3 += `<span class="${i<=num3?'act':''}"></span>`;
            
            
            // $('#speakers').innerHTML += html1;
            // $('#content').innerHTML += html2;
            // $('#arrange').innerHTML += html3;
        }
        $('.list').innerHTML = html;
         function aa(m, n) {
            m.innerHTML = '';
            let str = ` <i>播讲：</i>`;
            for (let i = 1; i <= 5; i++) {
                str += `<span class="${i <= n ? 'act' : ''}"></span>`;
            }
            m.innerHTML = str;
        }
        var b1 = document.querySelectorAll('#speakers');
        var b2 = document.querySelectorAll('#content');
        var b3 = document.querySelectorAll('#arrange');
        for (i = 0; i < arr.length; i++) {
            aa(b1[i], arr[i].star1);
            aa(b2[i], arr[i].star2);
            aa(b3[i], arr[i].star3);
        }
    //   console.log(html);
    // 遍历渲染星星
    // for(let j=0;j<arr.length;j++){
    //     let item1 = arr[j];
    //     // $('#speakers').innerHTML = '';
    //     // $('#content').innerHTML = '';
    //     // $('#arrange').innerHTML = '';
 
    //         $('#speakers').innerHTML =''
    //         $('#content').innerHTML =''
    //         $('#arrange').innerHTML =''
    //         let html1;
    //         let html2;
    //         let html3;

    //         let num1 = item1.speakers;
    //         let num2 = item1.content;
    //         let num3 = item1.arrange;
         
    //             html1 += `<span class="${j<=num1?'act':''}"></span>`;
    //             html2 += `<span class="${j<=num2?'act':''}"></span>`;
    //             html3 += `<span class="${j<=num3?'act':''}"></span>`;
            
            
    //         $('#speakers').innerHTML += html1;
    //         $('#content').innerHTML += html2;
    //         $('#arrange').innerHTML += html3;
    //     }
    // }
        // html += `<span class="${i<=num?'act':''}"></span>`;
         
        // class_star.innerHTML += html; 
    }
    )

   
</script>